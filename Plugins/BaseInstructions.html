<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>BaseInstructions &mdash; Chef 0.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Chef 0.9 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">Chef 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="baseinstructions">
<h1>BaseInstructions<a class="headerlink" href="#baseinstructions" title="Permalink to this headline">¶</a></h1>
<p>This plugin implements various custom instructions to control the behavior of symbolic execution from within the guest OS.
S2E extends the x86 instruction set with a custom opcode. This opcode takes an 8-bytes operand
that is passed to plugins that listen for custom instructions. The content of the operand is plugin specific.</p>
<div class="highlight-python"><div class="highlight"><pre>#S2E custom instruction format
0f 3f XX XX YY YY YY YY YY YY

XX: 16-bit instruction code. Each plugin should have a unique one.
YY: 6-bytes operands. Freely defined by the instruction code.
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">s2e.h</span></tt> defines a basic set of custom instructions. You can extend this by assigning an unused instruction code
to your custom instruction. S2E does not track instruction code allocation. S2E calls all the plugins that listen for
a custom opcode in the order of their registration.</p>
<div class="section" id="creating-symbolic-values-and-concretizing-them">
<h2>Creating symbolic values and concretizing them<a class="headerlink" href="#creating-symbolic-values-and-concretizing-them" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/** Make the content of the specified buffer symbolic */</span>
<span class="kt">void</span> <span class="nf">s2e_make_symbolic</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">);</span>


<span class="cm">/** Concretize the expression</span>
<span class="cm">/** This function adds path constraints */</span>
<span class="kt">void</span> <span class="nf">s2e_concretize</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">);</span>


<span class="cm">/** Get an example value for the expression stored in buf */</span>
<span class="cm">/** This function does NOT add path constraints. */</span>
<span class="kt">void</span> <span class="nf">s2e_get_example</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">);</span>


<span class="cm">/** Return an example value for the expression passed in val */</span>
<span class="cm">/** It is meant to be used in printf-like functions*/</span>
<span class="kt">unsigned</span> <span class="nf">s2e_get_example_uint</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">val</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="controlling-path-exploration">
<h2>Controlling path exploration<a class="headerlink" href="#controlling-path-exploration" title="Permalink to this headline">¶</a></h2>
<p>These functions control the path exploration from within the guest.
The guest can enable/disable forking as well as kill states at any point in the code.
When forking is disabled, S2E follows only one branch outcome, even if
both outcomes are feasible.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/** Enable forking on symbolic conditions. */</span>
<span class="kt">void</span> <span class="nf">s2e_enable_forking</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/** Disable forking on symbolic conditions. */</span>
<span class="kt">void</span> <span class="nf">s2e_disable_forking</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/** Terminate current state. */</span>
<span class="kt">void</span> <span class="nf">s2e_kill_state</span><span class="p">(</span><span class="kt">int</span> <span class="n">status</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">message</span><span class="p">)</span>

<span class="cm">/** Get the current execution path/state id. */</span>
<span class="kt">unsigned</span> <span class="n">s2e_get_path_id</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="printing-messages">
<h2>Printing messages<a class="headerlink" href="#printing-messages" title="Permalink to this headline">¶</a></h2>
<p>These custom instructions allow you to print messages and symbolic values
to the S2E log file. This is useful for debugging.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/** Print a message to the S2E log. */</span>
<span class="kt">void</span> <span class="nf">s2e_message</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">message</span><span class="p">);</span>

<span class="cm">/** Print a warning to the S2E log and S2E stdout. */</span>
<span class="kt">void</span> <span class="nf">s2e_warning</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">message</span><span class="p">);</span>

<span class="cm">/** Print a symbolic expression to the S2E log. */</span>
<span class="kt">void</span> <span class="nf">s2e_print_expression</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">message</span><span class="p">,</span> <span class="kt">int</span> <span class="n">expression</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="s2e-configuration">
<h2>S2E configuration<a class="headerlink" href="#s2e-configuration" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/** Get S2E version or 0 when running without S2E. */</span>
<span class="kt">int</span> <span class="nf">s2e_version</span><span class="p">();</span>


<span class="cm">/** Get the current S2E_RAM_OBJECT_BITS configuration macro */</span>
<span class="kt">int</span> <span class="nf">s2e_get_ram_object_bits</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="controlling-interrupt-behavior">
<h2>Controlling interrupt behavior<a class="headerlink" href="#controlling-interrupt-behavior" title="Permalink to this headline">¶</a></h2>
<p>These functions allow to speed up execution in some circumstances by
limiting the number of concrete/symbolic switches. <em>They can easily hang
your system. Use with care.</em></p>
<div class="highlight-c"><div class="highlight"><pre><span class="cm">/** Disable timer interrupt in the guest. */</span>
<span class="kt">void</span> <span class="nf">s2e_disable_timer_interrupt</span><span class="p">();</span>


<span class="cm">/** Enable timer interrupt in the guest. */</span>
<span class="kt">void</span> <span class="nf">s2e_enable_timer_interrupt</span><span class="p">();</span>


<span class="cm">/** Disable all APIC interrupts in the guest. */</span>
<span class="kt">void</span> <span class="nf">s2e_disable_all_apic_interrupts</span><span class="p">();</span>


<span class="cm">/** Enable all APIC interrupts in the guest. */</span>
<span class="kt">void</span> <span class="nf">s2e_enable_all_apic_interrupts</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">BaseInstructions</a><ul>
<li><a class="reference internal" href="#creating-symbolic-values-and-concretizing-them">Creating symbolic values and concretizing them</a></li>
<li><a class="reference internal" href="#controlling-path-exploration">Controlling path exploration</a></li>
<li><a class="reference internal" href="#printing-messages">Printing messages</a></li>
<li><a class="reference internal" href="#s2e-configuration">S2E configuration</a></li>
<li><a class="reference internal" href="#controlling-interrupt-behavior">Controlling interrupt behavior</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/Plugins/BaseInstructions.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">Chef 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Stefan Bucur.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>